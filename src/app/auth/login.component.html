<section id="wrapper" class="login-register">
    <div class="login-box login-sidebar">
        <div class="white-box">

            <form (ngSubmit)="signIn()" class="form-horizontal form-material" id="loginform" action="index.html" autocomplete="off">
                <a href="javascript:void(0)" class="text-center db m-t-100">
                    <img src="../../assets/layout/images/logo2x.png" alt="Home" />
                </a>

                <div class="form-group m-t-60">
                    <div class="col-xs-12">
                        <input name="username" class="form-control" type="text" [(ngModel)]="data.username" placeholder="Username">
                    </div>
                </div>
                <div class="form-group m-t-40">
                    <div class="col-xs-12 position-relative">
                        <input 
                            name="password" 
                            class="form-control" 
                            [type]="isPasswordVisible ? 'password' : 'text'" 
                            [(ngModel)]="data.password" 
                            (input)="checkPassword()" 
                            placeholder="Password" 
                            autocomplete="off" 
                            style="padding-right: 40px;">
                
                        <!-- Eye Icon for Show/Hide Password -->
                        <span 
                            *ngIf="data.password?.length" 
                            (click)="togglePasswordVisibility()" 
                            style="position: absolute; top: 50%; right: 10px; transform: translateY(-50%); cursor: pointer;">
                            
                            <!-- Eye Open Icon (Password Hidden) -->
                            <svg *ngIf="!isPasswordVisible" xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 24 24" width="20" fill="black">
                                <path d="M12 4.5C7.58 4.5 3.5 7.47 1 12c2.5 4.53 6.58 7.5 11 7.5s8.5-2.97 11-7.5c-2.5-4.53-6.58-7.5-11-7.5zm0 13c-3.87 0-7-3.13-7-7s3.13-7 7-7 7.13 3.13 7.13 7-3.13 7-7.13 7zm0-2c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm0-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1z"/>
                            </svg>
                
                            <!-- Eye Closed Icon (Password Visible) -->
                            <svg *ngIf="isPasswordVisible" xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 24 24" width="20" fill="black">
                                <path d="M12 4.5C7.58 4.5 3.5 7.47 1 12c2.5 4.53 6.58 7.5 11 7.5 2.21 0 4.26-.5 6.06-1.39l1.43 1.43c.26-.42.51-.86.74-1.31L2.79 4.22a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41L4.11 8c-1.77 1.37-3.14 3.14-4 5 2.5 4.53 6.58 7.5 11 7.5 3.14 0 6.01-1.09 8.35-2.92l2.8 2.8c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L2.79 4.22zM12 6c2.76 0 5 2.24 5 5 0 .73-.16 1.42-.44 2.04l-5-5c.62-.28 1.31-.44 2.04-.44zM12 18c-3.87 0-7-3.13-7-7 0-.73.16-1.42.44-2.04l3.46 3.46c-.62.28-1.31.44-2.04.44 0 2.76 2.24 5 5 5z"/>
                            </svg>
                        </span>
                    </div>
                </div>
                
                

                <div class="form-group text-center m-t-40">
                    <div class="col-xs-12">
                        <button [disabled]="!data.username || !data.password" class="btn btn-info btn-lg btn-block text-uppercase waves-effect waves-light">Log In</button>
                    </div>
                </div>

            </form>

        </div>
    </div>
</section>

<fintrakbanking-message [title]="title" [message]="message" [show]="show" [cssClass]="cssClass" (closeEvent)="hideMessage($event)"></fintrakbanking-message>

<app-two-factor-auth (emitLogout)="logOut()" [staffCode]="username" [display]="displayTwoFactorAuth" [redirect]="returnUrl"></app-two-factor-auth>


<p-dialog header="Password Change" [(visible)]="displayPasswordchange" [responsive]="true" showEffect="fade" [modal]="true"
    width="800">
    <div class="ui-g">

        <div class="card no-padding">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-md-12">
                            <h2 class="panel-title pull-left">
                                Password Change
                            </h2>
                            <!-- <button type="button" class="btn btn-primary pull-right" (click)="startLoanAppHome()">Cancel PEN</button> -->
                        </div>
                    </div>
                </div>

                <div class="panel-body">
                    <div class="form-horizontal">
                        <form novalidate [formGroup]="passwordForm" autocomplete="off">
                            <div class="ui-g">
                                <div class="ui-g-12">
                                    <div class="alert alert-danger"> {{passwordInfo}} </div>
                                </div>

                                <div class="ui-g-12">
                                    <label class="col-md-2" for="">Username</label>
                                    <div [ngClass]="'no-data-div'" class="col-md-6">
                                        <input class="form-control" [attr.disabled]="true" formControlName="username" id="username" type="text" [ngClass]="!passwordForm.controls['username'].valid ? 'required-input' : 'valid-input'">
                                    </div>

                                </div>

                                <div class="ui-g-12">
                                    <label class="col-md-2" for="">Current Password</label>
                                    <div class="col-md-6">
                                        <input class="form-control" formControlName="currentPassword" id="currentPassword" type="password" autocomplete="off" [ngClass]="!passwordForm.controls['currentPassword'].valid ? 'required-input' : 'valid-input'">
                                    </div>

                                </div>
                                <div class="ui-g-12">
                                    <label class="col-md-2" for="">New Password</label>
                                    <div class="col-md-6">
                                        <input class="form-control" autocomplete="off" formControlName="newPassword" id="newPassword" type="password" [ngClass]="!passwordForm.controls['newPassword'].valid ? 'required-input' : 'valid-input'">
                                    </div>
                                </div>

                                <div class="ui-g-12">
                                    <label class="col-md-2" for="">Confirm Password</label>
                                    <div class="col-md-6">
                                        <input class="form-control" autocomplete="off" formControlName="confirmPassword" id="confirmPassword" type="password" [ngClass]="!passwordForm.controls['confirmPassword'].valid ? 'required-input' : 'valid-input'">
                                    </div>
                                </div>

                            </div>
                        </form>
                    </div>
                </div>

            </div>
            <div class="panel-footer">
                <div class="row">
                    <div class="col-md-8">
                        <button type="submit" [disabled]="passwordForm.invalid" style="margin-right:5px" class="btn btn-success pull-right" (click)="onPasswordChange()">
                            Change Password </button>
                        <button type="button" style="margin-right:5px" class="btn btn-danger pull-right" (click)="hideModal()">Close</button>
                    </div>
                </div>
            </div>
        </div>

    </div>
</p-dialog>

<p-dialog header="Sign out" [(visible)]="allowSignoutPage" [responsive]="true" showEffect="fade" [modal]="true" width="500">
    <div style="margin-bottom:0" class="panel panel-default">
        <div class="panel-heading">
            <h2 class="panel-title">
                End Active Session
            </h2>
        </div>
        <div class="panel-body">
            <div class="form-horizontal">
                <p-messages [value]="msgs"></p-messages>
                <form class="form-horizontal form-material" id="logOutform" action="index.html" autocomplete="off">
                    <div class="form-group">
                        <label class="col-md-4" for="username">User Name</label>
                        <div class="col-md-8">
                            <input name="username" style="background-color:  #232232 ;" class="form-control" type="text" [(ngModel)]="data.username"
                                placeholder="Username">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-4" for="username">Password</label>
                        <div class="col-md-8">
                            <input name="password" style="background-color: #232232; " class="form-control" type="password" [(ngModel)]="data.password"
                                placeholder="Password">
                        </div>
                    </div>

                    <div class="form-group text-center">
                        <div class="col-md-12">
                            <button (click)="signOut($event)" [disabled]="!data.username || !data.password" class="btn btn-info btn-lg btn-block text-uppercase waves-effect waves-light">End Active Session</button>
                        </div>
                    </div>

                </form>
            </div>
        </div>
    </div>

</p-dialog>